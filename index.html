<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <title>NeoPrice</title>
    <link rel="icon" type="image/png" href="/assets/logo.jpeg">
</head>

<body>
    <header>
        <h1>Selamat Datang di NeoPrice</h1>
        <nav>
            <ul>
                <li><a href="#">Home</a></li>
                <li><a href="#news">Berita</a></li>
                <li><a href="#prices">Harga</a></li>
                <li><a href="#about">Tentang</a></li>
                <li><a href="#services">Visi/Misi</a></li>
                <li><a href="#contact">Kontak</a></li>
            </ul>
        </nav>
    </header>

    <div class="cover">
        <img src="/assets/komoditas_banner.jpg" alt="Cover Image"
            style="width: 100%; height:300px; object-fit: cover; display: block; margin: 0 auto;">
    </div>

    <div class="container">
        <section id="news">
            <h2>Berita Komoditas Terbaru</h2>
            <div class="newsContainer"></div>

            <script>
                async function loadArticles() {
                    const container = document.querySelector('.newsContainer');
                    container.innerHTML = "";

                    try {
                        const response = await fetch("https://api-panelhargav2.badanpangan.go.id/api/cms/articles?type=1&page=1");
                        const result = await response.json();

                        if (result.status === "success" && result.data.length > 0) {
                            result.data.forEach(article => {
                                const sourceUrlMatch = article.description.match(/Sumber\s*:\s*(https?:\/\/[^\s<]+)/);
                                const sourceUrl = sourceUrlMatch ? sourceUrlMatch[1] : "#";

                                container.innerHTML += `
                            <div class="newsItem">
                                <div class="image">
                                    <img src="${article.file}" alt="${article.title}">
                                </div>

                                <a href="${sourceUrl}" target="_blank" class="normalAnchor"><h3 class="title">${article.title}</h3></a>
                                <p class="description">${article.description.replace(/<[^>]+>/g, '').substring(0, 50) || ''} </p>
                                <a href="${sourceUrl}" target="_blank" >Read more.</a>
                            </div>
                            `;
                            });
                        } else {
                            container.innerHTML = "<p>Tidak ada berita ditemukan.</p>";
                        }

                    } catch (error) {
                        container.innerHTML = "<p>Gagal memuat berita. Silakan coba lagi nanti.</p>";
                        console.error("Fetch error:", error);
                    }
                }

                loadArticles();
            </script>
        </section>

        <section id="prices">
            <h1>Harga Pangan Informasi (Level Produsen)</h1>
            <div class="price-container" id="cards-container"> </div>

            <div class="prices-nav">
                <a onclick="prevPage()">Sebelumnya</a>
                <a onclick="nextPage()">Selanjutnya</a>
            </div>

            <script>
                let page = 1;
                const API_URL = "https://api-panelhargav2.badanpangan.go.id/api/front/harga-pangan-informasi?province_id=&city_id=&level_harga_id=";

                function formatNumber(num) {
                    return num.toLocaleString("id-ID");
                }

                function createCard(item) {
                    // Gap icon: panah ke atas/bawah
                    const gapIcon = item.gap_change === "up" ? "▲" : "▼";

                    const card = document.createElement("div");
                    card.className = "price-card";

                    card.innerHTML = `
                    <a href="/details.html?id=${item.id}" class="normalAnchor">
        <div class="price-card-header" style="background-image: url('${item.background}')"></div>
        <div class="price-card-body">
          <div class="price-name">${item.name}</div>
          <div class="price-price">${formatNumber(item.today)} <span class="price-unit">${item.satuan}</span></div>
          <div class="price-info-row">
            <div>Kemarin (${item.yesterday_date}): ${formatNumber(item.yesterday)}</div>
            <div class="price-gap ${item.gap_change}">
              ${item.gap > 0 ? "+" : ""}${formatNumber(item.gap)} (${item.gap_percentage.toFixed(2)}%)
              <span class="price-gap-icon">${gapIcon}</span>
            </div>
          </div>
        </div>
        </a>
      `;

                    return card;
                }

                async function loadData(id) {
                    try {
                        const response = await fetch(API_URL + id);
                        if (!response.ok) throw new Error("Gagal mengambil data");

                        const result = await response.json();

                        console.log(result);


                        if (result.status === "success" && Array.isArray(result.data)) {
                            const container = document.getElementById("cards-container");
                            container.innerHTML = ""; // clear first

                            result.data.forEach(item => {
                                const card = createCard(item);
                                container.appendChild(card);
                            });
                        } else {
                            console.error("Data tidak valid", result);
                            document.getElementById("cards-container").innerText = "Data tidak tersedia.";
                        }
                    } catch (error) {
                        console.error("Error fetching data:", error);
                        document.getElementById("cards-container").innerText = "Terjadi kesalahan saat mengambil data.";
                    }
                }

                function prevPage() {
                    if (page > 1) {
                        page--;
                        loadData(page);
                    }
                }
                function nextPage() {
                    page++;
                    loadData(page);
                }
                loadData(page);
            </script>

        </section>
        

        <div class="about-container" id="about">
            <div class="about-image">
                <img src="/assets/logo.jpeg" alt="About NeoPrice">
            </div>
            <div class="about-description">
                <h2>Tentang NeoPrice</h2>
                <p>NeoPrice menyediakan indeks harga komoditas terkini dan tren pasar untuk membantu Anda mengambil
                    keputusan yang terinformasi.</p>
            </div>
        </div>


        <div class="about-container" id="services">
            <div class="about-description">
                <p>
                <h2>Visi</h2>
                Menjadi sumber informasi harga komoditas yang akurat, transparan, dan mudah diakses untuk mendukung
                keputusan masyarakat, pelaku usaha, dan pemerintah dalam menciptakan pasar pangan yang sehat dan
                berkelanjutan.

                <h2>Misi</h2>
                <ol>
                    <li>Menyediakan data harga komoditas terkini secara cepat, jelas, dan terpercaya.</li>
                    <li>Memudahkan pengguna dalam membandingkan harga komoditas antar wilayah dan waktu.</li>
                    <li>Mendukung transparansi pasar dengan akses data yang terbuka bagi semua pihak.</li>
                    <li>Mengembangkan fitur analisis sederhana untuk membantu pelaku usaha mengambil keputusan.</li>
                    <li>Berkontribusi dalam menjaga stabilitas harga pangan melalui penyediaan informasi yang tepat.
                    </li>
                </ol>

                </p>
            </div>
            <div class="about-image">
                <img src="/assets/logo.jpeg" alt="About NeoPrice">
            </div>
        </div>
    </div>

    <div class="contact" id="contact">
        <span>
            <a href="">
                <img src="/assets/social-media/facebook.png" alt="" width="80px" height="80px">
            </a>
        </span>

        <span>
            <a href="">
                <img src="/assets/social-media/instagram.png" alt="" width="80px" height="80px">
            </a>
        </span>
        <span>
            <a href="">
                <img src="/assets/social-media/gmail.png" alt="" width="80px" height="80px">
            </a>
        </span>
        <span>
            <a href="">
                <img src="/assets/social-media/tiktok.png" alt="" width="80px" height="80px">
            </a>
        </span>
    </div>

    <footer>
        <div class="footer-container">
            <div class="footer-container-left">
                <img src="/assets/logo.jpeg" alt="Logo" style="width: 100px;">
                <h3>Tentang NeoPrice</h3>
                <p>NeoPrice menyediakan indeks harga komoditas terkini dan tren pasar untuk membantu Anda mengambil
                    keputusan yang terinformasi.</p>
            </div>

            <div class="footer-container-right">
                <span>
                    <h3>Halaman</h3>
                    <div class="footer-content-list">
                        <a href="#">Home</a>
                        <a href="#news">Berita</a>
                        <a href="#prices">Harga</a>
                        <a href="#about">Tentang</a>
                        <a href="#services">Visi/Misi</a>
                        <a href="#">Kontak</a>
                    </div>
                </span>

                <span>
                    <h3>Berita</h3>
                    <div class="footer-content-list footer-news-list"> </div>

                    <script>
                        async function loadArticles() {
                            const container = document.querySelector('.footer-news-list');
                            container.innerHTML = "";

                            try {
                                const response = await fetch("https://api-panelhargav2.badanpangan.go.id/api/cms/articles?type=1&page=1");
                                const result = await response.json();

                                if (result.status === "success" && result.data.length > 0) {
                                    result.data.slice(0, 4).forEach(article => {
                                        const sourceUrlMatch = article.description.match(/Sumber\s*:\s*(https?:\/\/[^\s<]+)/);
                                        const sourceUrl = sourceUrlMatch ? sourceUrlMatch[1] : "#";
                                        container.innerHTML += `<a href="${sourceUrl}" target="_blank">${article.title}</a>`;
                                    });
                                } else {
                                    container.innerHTML = "<p>Tidak ada berita ditemukan.</p>";
                                }

                            } catch (error) {
                                container.innerHTML = "<p>Gagal memuat berita. Silakan coba lagi nanti.</p>";
                                console.error("Fetch error:", error);
                            }
                        }

                        loadArticles();
                    </script>
                </span>

                <span>
                    <h3>Kontak Kami</h3>
                    <div class="footer-content-list">
                        <a href="mailto:support@neoprice.com">Email: support@neoprice.com</a>
                        <a href="tel:08123456789">Telepon: 08123456789</a>
                    </div>
                </span>
            </div>
        </div>
        <p>&copy; 2025 NeoPrice. All rights reserved.</p>
    </footer>
</body>

</html>